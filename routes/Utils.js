
function pdfHeader(clientCard,opNumber) {

    return `<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="es" lang="es">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>file_1700435761094</title>
    <meta name="author" content="XCPC" />
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        h1 {
            color: #006FC0;
            font-family: Cambria, serif;
            font-style: italic;
            font-weight: bold;
            text-decoration: underline;
            font-size: 15pt;
        }

        .s1 {
            color: #001F5F;
            font-family: "Arial Black", sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 10pt;
        }

        h2 {
            color: #001F5F;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 12pt;
        }

        .s2 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 8pt;
        }

        p {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 9.5pt;
            margin: 0pt;
        }

        .s3 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 8pt;
        }

        .s4 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 9.5pt;
        }

        .s5 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 8pt;
        }

        .s6 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 9.5pt;
        }

        .s7 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: underline;
            font-size: 8pt;
        }

        .s8 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: underline;
            font-size: 9.5pt;
        }

        .s9 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: underline;
            font-size: 9.5pt;
        }

        .s10 {
            color: #006FC0;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 9.5pt;
        }

        .s11 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: italic;
            font-weight: bold;
            text-decoration: none;
            font-size: 9.5pt;
        }

        .s12 {
            color: #001F5F;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 9.5pt;
        }

        .s13 {
            color: #001F5F;
            font-family: Calibri, sans-serif;
            font-style: italic;
            font-weight: bold;
            text-decoration: none;
            font-size: 9.5pt;
        }

        .s14 {
            color: #F00;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 10pt;
        }

        .s15 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 10pt;
        }

        .s16 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 12pt;
        }

        table,
        tbody {
            vertical-align: top;
            overflow: visible;
        }
    </style>
</head>

<body>
    <h1 style="padding-top: 1pt;padding-left: 159pt;text-indent: 0pt;text-align: center;">INVERSIONES ELLEN DE AMERICA
        S.A.</h1>
    <p class="s1" style="padding-top: 9pt;padding-left: 159pt;text-indent: 0pt;text-align: center;">CÉDULA JURÍDICA No.
        3-101-211191-02</p>
    <p style="text-indent: 0pt;text-align: left;"><br /></p>
    <h2 style="padding-left: 24pt;text-indent: 0pt;line-height: 15pt;text-align: left;">${opNumber}</h2>
    <p style="padding-left: 515pt;text-indent: 0pt;text-align: left;" />
    <table style="border-collapse:collapse" cellspacing="0">
        <tr style="height:12pt">
            <td
                style="width:50pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
                <p class="s2"
                    style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">
                    CED.JURIDICA</p>
            </td>
            <td
                style="width:135pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
                <p class="s2"
                    style="padding-top: 1pt;padding-left: 43pt;text-indent: 0pt;line-height: 9pt;text-align: left;">
                    ${clientCard}</p>
            </td>
        </tr>
        <tr style="height:12pt">
            <td style="width:185pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35"
                colspan="2">
                <p class="s2"
                    style="padding-top: 1pt;padding-left: 67pt;padding-right: 69pt;text-indent: 0pt;line-height: 9pt;text-align: center;">
                    CTA. CLIENTE:</p>
            </td>
        </tr>
    </table>`;
};

function invoicesHeader(clientName, opNumber, date){
    return `<p style="text-indent: 0pt;text-align: left;" />
    <p style="padding-left: 7pt;text-indent: 0pt;line-height: 11pt;text-align: left;">DETALLE DE PRÉSTAMO - OPERACIÓN #
        ${opNumber}-2023</p>
    <p style="padding-top: 1pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">CLIENTE: ${clientName}
    </p>
    <p style="padding-left: 7pt;text-indent: 0pt;text-align: left;">FECHA: <span class="s3">${formatDate(date)}</span></p>
    <p style="text-indent: 0pt;text-align: left;"><br /></p>
    <table style="border-collapse:collapse;margin-left:5.54791pt" cellspacing="0">
        <tr style="height:12pt">
            <td
                style="width:102pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt">
                <p class="s2"
                    style="padding-top: 1pt;padding-left: 34pt;padding-right: 33pt;text-indent: 0pt;line-height: 9pt;text-align: center;">
                    FACTURA</p>
            </td>
            <td style="width:245pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"
                colspan="2">
                <p class="s2"
                    style="padding-top: 1pt;padding-left: 89pt;padding-right: 88pt;text-indent: 0pt;line-height: 9pt;text-align: center;">
                    ENTIDAD</p>
            </td>
            <td
                style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
                <p class="s2"
                    style="padding-top: 1pt;padding-left: 15pt;text-indent: 0pt;line-height: 9pt;text-align: left;">
                    FECHA</p>
            </td>
            <td
                style="width:50pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
                <p class="s2"
                    style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">
                    SUB-TOTAL</p>
            </td>
            <td
                style="width:60pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
                <p class="s2"
                    style="padding-top: 1pt;padding-left: 15pt;text-indent: 0pt;line-height: 9pt;text-align: left;">
                    CÓDIGO</p>
            </td>
            <td
                style="width:75pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
                <p class="s2"
                    style="padding-top: 1pt;padding-left: 21pt;text-indent: 0pt;line-height: 9pt;text-align: left;">
                    COLONES</p>
            </td>
        </tr>`;
}
function invoicesBoddy(invoiceNumber, entity, date, amount){
    return `<tr style="height:12pt">
    <td
        style="width:102pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s4"
            style="padding-left: 34pt;padding-right: 33pt;text-indent: 0pt;line-height: 11pt;text-align: center;">
            ${invoiceNumber}</p>
    </td>
    <td style="width:245pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35"
        colspan="2">
        <p class="s4"
            style="padding-left: 89pt;padding-right: 89pt;text-indent: 0pt;line-height: 11pt;text-align: center;">
            ${entity}</p>
    </td>
    <td
        style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s4" style="padding-left: 17pt;text-indent: 0pt;line-height: 11pt;text-align: left;">${formatDate(date)}</p>
    </td>
    <td
        style="width:50pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s4" style="text-indent: 0pt;line-height: 11pt;text-align: right;">${amount}</p>
    </td>
    <td
        style="width:60pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
    <td
        style="width:75pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s4" style="text-indent: 0pt;line-height: 11pt;text-align: right;">${amount}</p>
    </td>
</tr>`;
}

function subTotal(factSum){
    return `<tr style="height:12pt">
    <td style="width:347pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35"
        colspan="3">
        <p class="s2"
            style="padding-top: 1pt;padding-left: 154pt;padding-right: 153pt;text-indent: 0pt;line-height: 9pt;text-align: center;">
            SUB-TOTAL</p>
    </td>
    <td
        style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
    <td
        style="width:50pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
    <td
        style="width:60pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s2"
            style="padding-top: 1pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">
            112-01-38-02</p>
    </td>
    <td
        style="width:75pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s2"
            style="padding-top: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">${factSum}</p>
    </td>
</tr>`
}

function retentionValue(retention, retentionCode, factSum) {
    return `<tr style="height:15pt">
    <td style="width:347pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35"
        colspan="3">
        <p class="s2"
            style="padding-top: 4pt;padding-left: 137pt;padding-right: 170pt;text-indent: 0pt;line-height: 10pt;text-align: center;">
            RETENCIÓN</p>
    </td>
    <td style="width:103pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35"
        colspan="2">
        <p class="s5"
            style="padding-top: 4pt;padding-left: 15pt;text-indent: 0pt;line-height: 10pt;text-align: left;">
            ${retention}%</p>
    </td>
    <td
        style="width:60pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt">
        <p class="s2"
            style="padding-top: 4pt;padding-right: 5pt;text-indent: 0pt;line-height: 10pt;text-align: right;">
            ${retentionCode}</p>
    </td>
    <td
        style="width:75pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s6" style="padding-top: 2pt;text-indent: 0pt;line-height: 11pt;text-align: right;">${(retention/100*factSum).toFixed(2)}
        </p>
    </td>
</tr>`
}

function comissionValue(comission, comissionCode, factSum){
    return `<tr style="height:12pt">
    <td
        style="width:102pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35">
        <p class="s5"
            style="padding-top: 1pt;padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">
            COMISIÓN:</p>
    </td>
    <td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35">
        <p class="s5"
            style="padding-top: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">
            1,00%</p>
    </td>
    <td style="width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
    <td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
    <td
        style="width:50pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
    <td
        style="width:60pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s2"
            style="padding-top: 1pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">
            ${comissionCode}</p>
    </td>
    <td
        style="width:75pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s2"
            style="padding-top: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">${(comission/100*factSum).toFixed(2)}</p>
    </td>
</tr>`
}

function legalExpenses(legalExpenses, legalExpensesCode,totalInterest, subTotal, transferCost){

    return `<tr style="height:24pt">
    <td style="width:400pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35" colspan="4">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
        <p class="s2" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">SUB-TOTAL</p>
    </td>
    <td style="width:50pt;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
    <td
        style="width:60pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
    <td style="width:75pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35"
        rowspan="11">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
        <p class="s2" style="padding-right: 1pt;text-indent: 0pt;text-align: right;">${subTotal}</p>
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
        <p class="s5" style="padding-left: 38pt;text-indent: 0pt;text-align: left;">${legalExpenses}</p>
        <p class="s2" style="padding-top: 2pt;padding-left: 34pt;text-indent: 0pt;text-align: left;">${totalInterest}
        </p>
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
        <p class="s5" style="padding-right: 1pt;text-indent: 0pt;text-align: right;">${transferCost}</p>
        <p class="s5"
            style="padding-top: 2pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">
            0,00</p>
    </td>
</tr>
<tr style="height:16pt">
    <td style="width:400pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35" colspan="4">
        <p class="s7" style="padding-top: 3pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">GASTOS DE
            FORMALIZACIÓN</p>
    </td>
    <td style="width:50pt;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
    <td
        style="width:60pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
</tr>
<tr style="height:12pt">
    <td style="width:400pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35" colspan="4">
        <p class="s2" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">Gastos Legales</p>
    </td>
    <td style="width:50pt;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
    <td
        style="width:60pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
</tr>
<tr style="height:11pt">
    <td style="width:400pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35" colspan="4">
        <p class="s5" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">
            Certificacion de cesión de facturas</p>
    </td>
    <td style="width:50pt;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s5" style="padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">${legalExpenses}
        </p>
    </td>
    <td
        style="width:60pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
</tr>
<tr style="height:12pt">
    <td style="width:400pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35" colspan="4">
        
    </td>
    <td
        style="width:50pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        
    </td>
    <td
        style="width:60pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s2"
            style="padding-top: 1pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">
            ${legalExpensesCode}</p>
    </td>
</tr>`

}

function monthInteretsHeader(date, endDate, term){
    return `<tr style="height:12pt">
    <td style="width:347pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35" colspan="3">
        <p class="s2"
            style="padding-top: 1pt;padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">
            Intereses del ${formatDate(date)} AL ${formatDate(endDate)}</p>
    </td>
    <td style="width:53pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35">
        <p class="s2"
            style="padding-top: 1pt;padding-right: 2pt;text-indent: 0pt;line-height: 9pt;text-align: right;">
            PLAZO</p>
    </td>
    <td
        style="width:50pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s2"
            style="padding-top: 1pt;padding-left: 12pt;text-indent: 0pt;line-height: 9pt;text-align: left;">${term}
            DIAS</p>
    </td>
    <td style="width:60pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35"
        rowspan="4">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
</tr>`
}

function monthInteretsBoddy(code, month, amount, total){
    return `<tr style="height:12pt">
    <td
        style="width:111pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s2"
            style="padding-top: 1pt;padding-left: 40pt;padding-right: 40pt;text-indent: 0pt;line-height: 9pt;text-align: center;">
            ${month}</p>
    </td>
    <td
        style="width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s2"
            style="padding-top: 1pt;padding-left: 40pt;padding-right: 40pt;text-indent: 0pt;line-height: 9pt;text-align: center;">
            ${code}</p>
    </td>
    <td
        style="width:53pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s2"
            style="padding-top: 1pt;padding-left: 9pt;text-indent: 0pt;line-height: 9pt;text-align: left;">
            ${amount}</p>
    </td>
    <td
        style="width:50pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;">${total === null ?'<br />':total}</p>
    </td>
</tr>`
}

function tranferCost(transferCode){
    return `<tr style="height:12pt">
    <td style="width:213pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35" colspan="2">
        <p class="s5"
            style="padding-top: 1pt;padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">
            Trámite Depósito SINPE - MUCAP - BNCR</p>
    </td>
    <td style="width:187pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35"
        colspan="2" rowspan="6">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
    <td style="width:50pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35"
        rowspan="4">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
    <td
        style="width:60pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s2"
            style="padding-top: 1pt;padding-right: 5pt;text-indent: 0pt;line-height: 9pt;text-align: right;">
            ${transferCode}</p>
    </td>
</tr>`
}

function feeBoddy(feeApply, factSum, totalCosts, feeCode, subTotal){
    return `<tr style="height:12pt">
    <td style="width:213pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35" colspan="2">
        <p class="s5"
            style="padding-top: 1pt;padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">
            Menos: 2% Impuestos sobre Renta</p>
    </td>
    <td
        style="width:60pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;">${feeApply ? (factSum*0.02).toFixed(2): ''}</p>
    </td>
</tr>
<tr style="height:12pt">
    <td style="width:213pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt"
        colspan="2">
        <p class="s2"
            style="padding-top: 1pt;padding-left: 79pt;padding-right: 81pt;text-indent: 0pt;line-height: 9pt;text-align: center;">
            TOTAL COSTOS</p>
    </td>
    <td
        style="width:60pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;">${feeApply ? feeCode: ''}</p>
    </td>
    <td
        style="width:75pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p class="s2"
            style="padding-top: 1pt;padding-right: 1pt;text-indent: 0pt;line-height: 9pt;text-align: right;">${totalCosts}</p>
    </td>
</tr>
<tr style="height:46pt">
            <td style="width:213pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35"
                colspan="2">
                <p style="text-indent: 0pt;text-align: left;"><br /></p>
                <p class="s8" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">MONTO NETO A GIRAR</p>

            </td>
            <td
                style="width:60pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
                <p style="text-indent: 0pt;text-align: left;"><br /></p>
                <p class="s6" style="padding-right: 4pt;text-indent: 0pt;line-height: 11pt;text-align: right;">
                    200-04-01-17</p>
            </td>
            <td
                style="width:75pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
                <p style="text-indent: 0pt;text-align: left;"><br /></p>
                <p class="s11" style="padding-right: 1pt;text-indent: 0pt;text-align: right;">₡${subTotal}</p>
            </td>
        </tr>
        <tr style="height:12pt">
            <td style="width:213pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35"
                colspan="2">
                <p class="s9" style="padding-left: 1pt;text-indent: 0pt;line-height: 11pt;text-align: left;">DEDUCCIONES</p>
            </td>
            <td
                style="width:50pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
                <p style="text-indent: 0pt;text-align: left;"><br /></p>
            </td>
            <td
                style="width:60pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
                <p style="text-indent: 0pt;text-align: left;"><br /></p>
            </td>
        </tr>
        <tr >
        </tr>`
}
function deductions(description, amount, opNumber, code) {
    return`
    <tr style="height:13pt">
            <td style="width:347pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"
                colspan="3" >
                <p class="s6" style="padding-left: 1pt;text-indent: 0pt;line-height: 11pt;text-align: left;">${opNumber + ' '+ description}</p>
            </td>
            <td style="width:53pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"
                >
                <p class="s6" style="text-indent: 0pt;line-height: 11pt;text-align: right;"></p>
            </td>
            <td style="width:50pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"
                >
                <p class="s6" style="text-indent: 0pt;line-height: 11pt;text-align: right;">${amount.toFixed(2)}</p>
            </td>
            <td
                style="width:60pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
                <p class="s6" style="padding-right: 4pt;text-indent: 0pt;line-height: 11pt;text-align: right;">
                ${code}</p>
            </td>
            <td
                style="width:75pt;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
                <p class="s14" style="text-indent: 0pt;line-height: 11pt;text-align: right;">${amount.toFixed(2)}</p>
            </td>
        </tr>`;
}

function endOp(total, sumDeductionsValue){
    return `<tr style="height:13pt">
    <td style="width:450pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35"
        colspan="5" bgcolor="#00AF50">
        <p class="s6" style="padding-left: 1pt;text-indent: 0pt;line-height: 11pt;text-align: left;">SUB TOTAL
            DEDUCCIONES</p>
    </td>
    <td style="width:60pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35"
        bgcolor="#00AF50">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
    <td style="width:75pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35"
        bgcolor="#00AF50">
        <p class="s15" style="text-indent: 0pt;line-height: 11pt;text-align: right;">₡${sumDeductionsValue}</p>
    </td>
</tr>
<tr style="height:8pt">
    <td style="width:450pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35"
        colspan="5">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
    <td
        style="width:60pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
    <td
        style="width:75pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35">
        <p style="text-indent: 0pt;text-align: left;"><br /></p>
    </td>
</tr>
<tr style="height:15pt">
    <td style="width:450pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35"
        colspan="5" bgcolor="#92D050">
        <p class="s9"
            style="padding-top: 2pt;padding-left: 1pt;text-indent: 0pt;line-height: 11pt;text-align: left;">
            DEPOSITO EN CTA. BANCARIA</p>
    </td>
    <td style="width:60pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35"
        bgcolor="#92D050">
        <p class="s15"
            style="padding-top: 2pt;padding-right: 8pt;text-indent: 0pt;line-height: 12pt;text-align: right;">
            100-01-01</p>
    </td>
    <td style="width:75pt;border-top-style:solid;border-top-width:1pt;border-top-color:#212B35;border-left-style:solid;border-left-width:1pt;border-left-color:#212B35;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#212B35;border-right-style:solid;border-right-width:1pt;border-right-color:#212B35"
        bgcolor="#92D050">
        <p class="s16" style="padding-right: 1pt;text-indent: 0pt;line-height: 14pt;text-align: right;">${total}</p>
    </td>
</tr>
</table>
<p style="text-indent: 0pt;text-align: left;"><br /></p>
<p style="padding-left: 5pt;text-indent: 0pt;line-height: 1pt;text-align: left;" />
<p style="padding-left: 137pt;text-indent: 0pt;text-align: left;">RECIBIDO CONFORME</p>
<p style="padding-top: 1pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">CEDULA NO.</p>
</body>

</html>`
}
function obtainDates(term,date) {
    const result = [];
    let dateInfo = new Date(date);

    while (term > 0) {
        const month = dateInfo.toLocaleString('default', { month: 'long' });
        const daysMonth = new Date(dateInfo.getFullYear(), dateInfo.getMonth() + 1, 0).getDate();
        const daysInMonth = daysMonth - dateInfo.getDate() + 1;
        const takenDays = Math.min(term, daysInMonth);

        result.push({ month: month, days: takenDays, interest: 0 });
        term -= takenDays;
        dateInfo.setMonth(dateInfo.getMonth() + 1, 1);
    }

    return result;
}
const formatDate = (dateString) => {
    const date = new Date(dateString);
    const month = date.getMonth() + 1;
    const day = date.getDate();
    const year = date.getFullYear();

    return `${day}-${month}-${year}`;
};
module.exports = {pdfHeader,invoicesHeader,invoicesBoddy,subTotal,retentionValue,comissionValue,
    legalExpenses,monthInteretsHeader,monthInteretsBoddy,tranferCost,feeBoddy,deductions,endOp,obtainDates,}